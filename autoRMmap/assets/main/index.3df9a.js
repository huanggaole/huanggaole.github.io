window.__require=function t(e,i,a){function s(h,r){if(!i[h]){if(!e[h]){var n=h.split("/");if(n=n[n.length-1],!e[n]){var l="function"==typeof __require&&__require;if(!r&&l)return l(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+h+"'")}h=n}var c=i[h]={exports:{}};e[h][0].call(c.exports,function(t){return s(e[h][1][t]||t)},c,c.exports,t,e,i,a)}return i[h].exports}for(var o="function"==typeof __require&&__require,h=0;h<a.length;h++)s(a[h]);return s}({LoadingScript:[function(t,e,i){"use strict";cc._RF.push(e,"bd9edQsI95N8IM9CGEUw/Tk","LoadingScript");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0});var h=t("./tileManager"),r=cc._decorator,n=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.processLabel=null,e.UI=null,e}return s(e,t),e.prototype.start=function(){},e.prototype.update=function(){var t=h.TileSet.finished/39;this.processLabel.string="Loading......\n\n\u52a0\u8f7d\u4e2d \u2026\u2026\n\n"+Math.floor(100*t)+"%",t>=1&&(this.UI.active=!1)},o([l(cc.Label)],e.prototype,"processLabel",void 0),o([l(cc.Node)],e.prototype,"UI",void 0),o([n],e)}(cc.Component);i.default=c,cc._RF.pop()},{"./tileManager":"tileManager"}],caveScript:[function(t,e,i){"use strict";cc._RF.push(e,"a3e1b6B1OpGOqx4Sq52rCiA","caveScript");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0});var h=t("./mainScript"),r=t("./saveFile"),n=t("./tileManager"),l=cc._decorator,c=l.ccclass,d=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.genBtn=null,e.widthText=null,e.heightText=null,e.typeToggle=null,e.mapSprite=null,e.ornamentsNode=null,e.ornamentsSlider=null,e.densityLabel=null,e.ornamentsBtn=null,e.clearBtn=null,e.saveBtn=null,e.width=10,e.height=10,e.ornamentsdensity=.3,e.tilesetId=3,e.data1=[],e.data2=[],e.data3=[],e.data4=[],e.data5=[],e.data6=[],e.eightX=[-1,0,1,-1,1,-1,0,1],e.eightY=[-1,-1,-1,0,0,1,1,1],e.fourX=[-1,1,0,0],e.fourY=[0,0,-1,1],e.Base=1553,e.Base2=3296,e.Wall=6320,e.WallTop=5936,e.Stone1=[],e.prob1=[],e.Stone21=65,e.Stone22=73,e.WalkableStone=49,e.WalkableBase=1625,e.Hole=3392,e.Lake=2528,e.WallDecTop=[],e.probWallTop=[],e.WallDecDown=[],e.probWallDown=[],e.Wall21=[],e.Wall22=[],e.probWall2=[],e.widthmargin=3,e.heightmargin=3,e}var i;return s(e,t),i=e,e.prototype.start=function(){for(var t=this,e=function(t){a.typeToggle.node.children[t].on("click",function(){i.typeSeleceted=t},a)},a=this,s=0;s<this.typeToggle.node.children.length;s++)e(s);this.genBtn.node.on("click",function(){t.width=+t.widthText.string,t.height=+t.heightText.string,!t.width||t.width<=0||NaN===t.width?alert("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5730\u56fe\u5bbd\u5ea6\nPlease enter a valid map width"):!t.height||t.height<=0||NaN===t.height?alert("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5730\u56fe\u9ad8\u5ea6\nPlease enter a valid map height"):t.generateMap()},this),this.ornamentsSlider.node.on("slide",function(){t.ornamentsdensity=t.ornamentsSlider.progress,t.densityLabel.string=Math.floor(100*t.ornamentsdensity)+"%"},this),this.ornamentsBtn.node.on("click",function(){t.cleardeco(),t.adddeco(),t.DrawMap(),t.ornamentsBtn.getComponentInChildren(cc.Label).string="Refresh Ornaments(\u91cd\u65b0\u88c5\u9970)"},this),this.clearBtn.node.on("click",function(){t.cleardeco(),t.DrawMap()},this),this.saveBtn.node.on("click",function(){r.saveFile.instance.saveMap(r.saveFile.instance.tostring(t.tilesetId+1,t.width,t.height,t.data),"application/json","test")},this)},e.prototype.genstr=function(){for(var t=this.width,e=this.height,i="",a=0;a<=5;a++)for(var s=0;s<t*e;s++)0==a&&0==s||(i+=","),i+=this.data[a*t*e+s].toString();return i},e.prototype.generateMap=function(){this.data1=[],this.data2=[],this.data3=[],this.data4=[],this.data5=[],this.data6=[];for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)this.data1.push(0),this.data2.push(0),this.data3.push(0),this.data4.push(0),this.data5.push(0),this.data6.push(0);this.initTilesType(),this.width<=25&&this.height<=25?this.initSmallRandomMap():(this.initRandomMap(),this.autoCell()),this.connectAllBase(),this.generateLakeandHole(),this.generateWall(),this.fillWallTops(),this.generateBase2(),this.updateAutoTiles(),this.data=this.data1.concat(this.data2.concat(this.data3.concat(this.data4.concat(this.data5.concat(this.data6))))),this.DrawMap()},e.prototype.DrawMap=function(){var t=new cc.RenderTexture,e=document.createElement("canvas");e.width=48*this.width,e.height=48*this.height;for(var i=e.getContext("2d"),a=0;a<this.data.length;a++){var s=Math.floor(a/(this.width*this.height)),o=a%(this.width*this.height),h=Math.floor(o/this.width),r=o%this.width,l=this.data[a];if(s<4&&l>0&&l<8192){var c=48*r,d=48*h,p=n.default.tileSets[this.tilesetId].tiletextures[l].img,u=n.default.tileSets[this.tilesetId].tiletextures[l].locUL,f=n.default.tileSets[this.tilesetId].tiletextures[l].locUR,w=n.default.tileSets[this.tilesetId].tiletextures[l].locDL,y=n.default.tileSets[this.tilesetId].tiletextures[l].locDR;i.drawImage(p,u.x,u.y,24,24,c,d,24,24),i.drawImage(p,f.x,f.y,24,24,c+24,d,24,24),i.drawImage(p,w.x,w.y,24,24,c,d+24,24,24),i.drawImage(p,y.x,y.y,24,24,c+24,d+24,24,24)}}t.initWithElement(e);var g=new cc.SpriteFrame(t);this.mapSprite.spriteFrame=g,this.ornamentsNode.active=!0},e.prototype.fillFlood=function(t,e,i,a,s){var o=[],h=new cc.Vec2(i,a);o.push(h),s[a*this.width+i]=e;for(var r=0;r<o.length;){var n=o[r];r++;for(var l=0;l<4;l++){var c=new cc.Vec2(n.x+this.fourX[l],n.y+this.fourY[l]);this.data1[c.y*this.width+c.x]===t&&s[c.y*this.width+c.x]!=e&&(s[c.y*this.width+c.x]=e,o.push(c))}}return o},e.prototype.initTilesType=function(){0===i.typeSeleceted?(this.Base=2816,this.Base2=2912,this.Wall=6272,this.WallTop=5888,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[56,108,9,242],this.Stone21=64,this.Stone22=72,this.WalkableStone=48,this.WallDecTop=[144,0],this.Wall21=[153,0],this.Wall22=[161,0]):(this.Stone1=[40,124,199,242],this.Stone21=48,this.Stone22=56,this.WalkableStone=32,this.WallDecTop=[176,0],this.Wall21=[185,0],this.Wall22=[193,0]),this.WalkableBase=1624,this.Hole=3008,this.Lake=2432,this.prob1=[0,.4,.8,.9],this.probWall2=[0,.1],this.probWallTop=[0,.1],this.WallDecDown=[0],this.probWallDown=[0]):1===i.typeSeleceted?(this.Base=3200,this.Base2=3296,this.Wall=6320,this.WallTop=5936,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[57,104,167,242],this.Stone21=65,this.Stone22=73,this.WalkableStone=49,this.WallDecTop=[155,144,165,0],this.Wall21=[152,153,154,0],this.Wall22=[160,161,162,0],this.WallDecDown=[163,167,0]):(this.Stone1=[41,120,190,242],this.Stone21=49,this.Stone22=57,this.WalkableStone=33,this.WallDecTop=[187,176,196,0],this.Wall21=[184,185,186,0],this.Wall22=[192,193,194,0],this.WallDecDown=[1,190,0]),this.prob1=[0,.4,.8,.9],this.WalkableBase=1625,this.Hole=3392,this.Lake=2528,this.probWall2=[0,.1,.2,.3],this.probWallTop=[0,.1,.2,.4],this.probWallDown=[0,.1,.3]):2===i.typeSeleceted?(this.Base=3584,this.Base2=3680,this.Wall=6368,this.WallTop=5984,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[58,242],this.Stone21=66,this.Stone22=74,this.WalkableStone=50,this.Wall21=[156,0],this.Wall22=[164,0]):(this.Stone1=[42,242],this.Stone21=50,this.Stone22=58,this.WalkableStone=34,this.Wall21=[187,0],this.Wall22=[195,0]),this.prob1=[0,.9],this.WalkableBase=1626,this.Hole=3776,this.Lake=2240,this.probWall2=[0,.1],this.WallDecTop=[0],this.probWallTop=[0],this.WallDecDown=[0],this.probWallDown=[0]):3===i.typeSeleceted?(this.Base=3968,this.Base2=4064,this.Wall=6416,this.WallTop=6032,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[59,106],this.Stone21=67,this.Stone22=75,this.WalkableStone=51,this.WallDecTop=[166,0],this.WallDecDown=[158,0],this.Wall21=[157,0],this.Wall22=[165,0]):(this.Stone1=[43,122],this.Stone21=51,this.Stone22=59,this.WalkableStone=35,this.WallDecTop=[197,0],this.WallDecDown=[189,0],this.Wall21=[188,0],this.Wall22=[196,0]),this.prob1=[0,.9],this.WalkableBase=1627,this.Hole=3440,this.Lake=3440,this.probWall2=[0,.1],this.probWallTop=[0,.1],this.probWallDown=[0,.1]):4===i.typeSeleceted?(this.Base=2864,this.Base2=2960,this.Wall=6464,this.WallTop=6080,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[1,9,60,105,48,242],this.Stone21=68,this.Stone22=76,this.Wall21=[152,154],this.Wall22=[160,162],this.WallDecTop=[155,144],this.WallDecDown=[163,155],this.WalkableStone=52):(this.Stone1=[191,199,44,121,32,242],this.Stone21=52,this.Stone22=60,this.Wall21=[184,186],this.Wall22=[192,194],this.WallDecTop=[9,176],this.WallDecDown=[1,9],this.WalkableStone=36),this.prob1=[0,.2,.4,.6,.8,.9],this.WalkableBase=1628,this.Hole=3056,this.Lake=2336,this.probWall2=[0,.5],this.probWallTop=[0,.9],this.probWallDown=[0,.7]):5===i.typeSeleceted?(this.Base=3248,this.Base2=3344,this.Wall=6512,this.WallTop=6128,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[61],this.Stone21=69,this.Stone22=77,this.WalkableStone=53):(this.Stone1=[45],this.Stone21=53,this.Stone22=61,this.WalkableStone=37),this.prob1=[0],this.WalkableBase=1629,this.Hole=4160,this.Lake=2624,this.Wall21=[0],this.Wall22=[0],this.probWall2=[0],this.WallDecTop=[0],this.probWallTop=[0],this.WallDecDown=[0],this.probWallDown=[0]):6===i.typeSeleceted?(this.Base=3632,this.Base2=3632,this.Wall=6560,this.WallTop=6176,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[62],this.Stone21=70,this.Stone22=78,this.WalkableStone=54):(this.Stone1=[46],this.Stone21=54,this.Stone22=62,this.WalkableStone=38),this.prob1=[0],this.WalkableBase=1630,this.Hole=3824,this.Lake=3824,this.Wall21=[0],this.Wall22=[0],this.probWall2=[0],this.WallDecTop=[0],this.probWallTop=[0],this.WallDecDown=[0],this.probWallDown=[0]):7===i.typeSeleceted&&(this.Base=4016,this.Base2=4016,this.Wall=6608,this.WallTop=6224,h.default.editorType==h.EditorType.RMMV?(this.Stone1=[63,62,61],this.Stone21=71,this.Stone22=79,this.WalkableStone=55,this.Wall21=[153,0],this.Wall22=[161,0],this.WallDecTop=[144,0]):(this.Stone1=[47,46,45],this.Stone21=55,this.Stone22=63,this.WalkableStone=39,this.Wall21=[185,0],this.Wall22=[193,0],this.WallDecTop=[176,0]),this.prob1=[0,.4,.7],this.WalkableBase=1631,this.Hole=4208,this.Lake=4208,this.probWall2=[0,.2],this.probWallTop=[0,.1],this.WallDecDown=[0],this.probWallDown=[0])},e.prototype.initSmallRandomMap=function(){if(!(this.width<2*this.widthmargin+1||this.height<2*this.heightmargin+1))for(var t=2+Math.floor(Math.random()*this.width*this.height/6),e=0;e<t;e++){var i=this.widthmargin+Math.floor(Math.random()*(this.width-2*this.widthmargin)),a=this.heightmargin+Math.floor(Math.random()*(this.height-2*this.heightmargin));this.data1[a*this.width+i]=this.Base}},e.prototype.initRandomMap=function(){this.widthmargin=3,this.heightmargin=3;for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)e>this.widthmargin&&e<this.width-this.widthmargin&&t>this.heightmargin&&t<this.height-this.heightmargin&&(this.data1[t*this.width+e]=2*Math.random()<1?0:this.Base)},e.prototype.autoCell=function(){for(var t=100,e=new Array(this.data1.length),i=0;i<this.data1.length;i++)e[i]=this.data1[i];for(;t>0;){for(t--,i=this.heightmargin;i<this.height-this.heightmargin;i++)for(var a=this.widthmargin;a<this.width-this.widthmargin;a++){for(var s=0,o=i-1;o<=i+1;o++)for(var h=a-1;h<=a+1;h++)o==i&&h==a||e[o*this.width+h]==this.Base&&s++;s>4?this.data1[i*this.width+a]=this.Base:s<4&&(this.data1[i*this.width+a]=0)}for(i=0;i<this.data1.length;i++)e[i]=this.data1[i]}},e.prototype.connectAllBase=function(){for(var t=new Array(this.height*this.width),e=[],i=0;i<this.height;i++)for(var a=0;a<this.width;a++)t[i*this.width+a]=-1;var s=0;for(i=0;i<this.height;i++)for(a=0;a<this.width;a++)if(this.data1[i*this.width+a]===this.Base&&-1===t[i*this.width+a]){var o=this.fillFlood(this.Base,s,a,i,t);e.push(o),s++}if(1!==e.length){var h=0,r=0;for(i=0;i<e.length;i++)e[i].length>r&&(h=i,r=e[i].length);for(i=0;i<e.length;i++)if(i!==h){var n=[];for(a=0;a<10;a++){var l=[],c=e[i][Math.floor(Math.random()*e[i].length)];l.push(c),n.push(l)}for(var d=-1;;){for(a=0;a<10;a++){var p=n[a][n[a].length-1],u=Math.floor(4*Math.random()),f=new cc.Vec2(p.x+this.fourX[u],p.y+this.fourY[u]);if(f.x>=this.widthmargin&&f.x<this.width-this.widthmargin&&f.y>=this.heightmargin&&f.y<this.height-this.heightmargin&&(n[a].push(f),t[f.y*this.width+f.x]===h)){d=a;break}}if(d>=0){for(a=0;a<n[d].length;a++)p=n[d][a],this.data1[p.y*this.width+p.x]=this.Base,t[p.y*this.width+p.x]=h;for(a=0;a<e[i].length;a++)t[(p=e[i][a]).y*this.width+p.x]=h;break}}}}},e.prototype.generateLakeandHole=function(){for(var t=new Array(this.height*this.width),e=[],i=0;i<this.height;i++)for(var a=0;a<this.width;a++)t[i*this.width+a]=-1;var s=0;for(i=0;i<this.height;i++)for(a=0;a<this.width;a++)if(0===this.data1[i*this.width+a]&&-1===t[i*this.width+a]){var o=this.fillFlood(0,s,a,i,t);e.push(o),s++}for(i=1;i<e.length;i++)if(Math.random()<.5)if(Math.random()<.5)for(a=0;a<e[i].length;a++)this.data1[e[i][a].y*this.width+e[i][a].x]=this.Hole;else for(a=0;a<e[i].length;a++)this.data1[e[i][a].y*this.width+e[i][a].x]=this.Lake},e.prototype.generateWall=function(){for(var t=this.height-2;t>2;t--)for(var e=this.width-2;e>2;e--)this.data1[t*this.width+e]===this.Base&&this.data1[(t-2)*this.width+e]===this.Base&&(this.data1[(t-1)*this.width+e]=this.Base),this.data1[t*this.width+e]===this.Base&&this.data1[(t-3)*this.width+e]===this.Base&&(this.data1[(t-1)*this.width+e]=this.Base,this.data1[(t-2)*this.width+e]=this.Base);for(t=this.height-2;t>=2;t--)for(e=this.width-1;e>0;e--)this.data1[t*this.width+e]===this.Base&&0===this.data1[(t-1)*this.width+e]&&0===this.data1[(t-2)*this.width+e]&&(this.data1[(t-1)*this.width+e]=this.Wall,t-3>=0&&0===this.data1[(t-3)*this.width+e]&&(this.data1[(t-2)*this.width+e]=this.Wall));for(t=1;t<this.height-1;t++)for(e=1;e<this.width-1;e++)if(0===this.data1[t*this.width+e])for(var i=0;i<8;i++){var a=this.data1[(t+this.eightY[i])*this.width+e+this.eightX[i]];a!==this.Wall&&a!==this.Base||(this.data1[t*this.width+e]=this.WallTop)}},e.prototype.fillWallTops=function(){for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)0===this.data1[t*this.width+e]&&(this.data1[t*this.width+e]=this.WallTop)},e.prototype.generateBase2=function(){if(this.Base2!==this.Base)for(var t=Math.floor(Math.random()*Math.sqrt(this.width+this.height)),e=0;e<t;e++){var i=1+Math.floor(Math.random()*this.width-2),a=1+Math.floor(Math.random()*this.height-2);if(this.data1[a*this.width+i]===this.Base){var s=Math.floor(5*Math.random()),o=Math.floor(5*Math.random()),h=Math.floor(5*Math.random()),r=Math.floor(5*Math.random());this.renderBase2(i,a,s,h,r,o)}else e--}},e.prototype.renderBase2=function(t,e,i,a,s,o){var h=0;if(this.data1[e*this.width+t]===this.Base||this.data1[e*this.width+t]===this.Base2){for(var r=0;r<8;r++){var n=t+this.eightX[r],l=e+this.eightY[r];this.data1[l*this.width+n]!==this.Base&&this.data1[l*this.width+n]!==this.Base2||h++}if(h>=7){this.data1[e*this.width+t]=this.Base2;for(var c=0;c<4;c++)0==c&&i>0&&this.renderBase2(t+this.fourX[c],e+this.fourY[c],i-1,i-1,i-1,i-1),1==c&&a>0&&this.renderBase2(t+this.fourX[c],e+this.fourY[c],a-1,a-1,a-1,a-1),2==c&&s>0&&this.renderBase2(t+this.fourX[c],e+this.fourY[c],s-1,s-1,s-1,s-1),3==c&&o>0&&this.renderBase2(t+this.fourX[c],e+this.fourY[c],o-1,o-1,o-1,o-1)}}},e.prototype.updateAutoTiles=function(){for(var t=new Array(this.data1.length),e=0;e<this.data1.length;e++)t[e]=this.data1[e];for(var i=!0;i;)for(i=!1,e=1;e<this.height-1;e++)for(var a=1;a<this.width-1;a++){var s=this.data1[(e-1)*this.width+a-1],o=this.data1[(e-1)*this.width+a],h=this.data1[(e-1)*this.width+a+1],r=this.data1[e*this.width+a-1],n=this.data1[e*this.width+a+1],l=this.data1[(e+1)*this.width+a-1],c=this.data1[(e+1)*this.width+a],d=this.data1[(e+1)*this.width+a+1],p=this.data1[e*this.width+a];t[e*this.width+a]===this.Wall&&(this.data1[e*this.width+a]=this.updateWall(t[e*this.width+a],s,o,h,r,n,l,c,d),p!==this.data1[e*this.width+a]&&(i=!0)),t[e*this.width+a]===this.Base2&&this.Base2!==this.Base&&(this.data1[e*this.width+a]=this.updateFloor(t[e*this.width+a],s,o,h,r,n,l,c,d),p!==this.data1[e*this.width+a]&&(i=!0)),t[e*this.width+a]===this.WallTop&&(this.data1[e*this.width+a]=this.updateFloor(t[e*this.width+a],s,o,h,r,n,l,c,d),p!==this.data1[e*this.width+a]&&(i=!0)),t[e*this.width+a]===this.Hole&&(this.data1[e*this.width+a]=this.updateFloor(t[e*this.width+a],s,o,h,r,n,l,c,d),p!==this.data1[e*this.width+a]&&(i=!0)),t[e*this.width+a]===this.Lake&&(this.data1[e*this.width+a]=this.updateFloor(t[e*this.width+a],s,o,h,r,n,l,c,d),p!==this.data1[e*this.width+a]&&(i=!0))}},e.prototype.updateWall=function(t,e,i,a,s,o,h,r){var n=!0,l=!0,c=!0,d=!0;i<t||i>t+15?n=!1:(i%2==1&&(c=!1),Math.floor(i/4)%2==1&&(d=!1)),r<t||r>t+15?l=!1:(r%2==1&&(c=!1),Math.floor(r/4)%2==1&&(d=!1)),(s<t||s>t+15)&&(c=!1),(o<t||o>t+15)&&(d=!1);var p=t;return!1===c&&(p+=1),!1===d&&(p+=4),!1===n&&(p+=2),!1===l&&(p+=8),p},e.prototype.updateFloor=function(t,e,i,a,s,o,h,r,n){var l=!0,c=!0,d=!0,p=!0,u=!0,f=!0,w=!0,y=!0;(e<t||e>t+48)&&(l=!1),(i<t||i>t+48)&&(c=!1),(a<t||a>t+48)&&(d=!1),(s<t||s>t+48)&&(w=!1),(o<t||o>t+48)&&(y=!1),(h<t||h>t+48)&&(p=!1),(r<t||r>t+48)&&(u=!1),(n<t||n>t+48)&&(f=!1);var g=t;return d=!d,w=!w,y=!y,p=!p,u=!u,f=!f,(c=!c)||w||y||u||(g+=0),!(l=!l)||c||d||w||y||p||u||f||(g+=1),l||c||!d||w||y||p||u||f||(g+=2),!l||c||!d||w||y||p||u||f||(g+=3),l||c||d||w||y||p||u||!f||(g+=4),!l||c||d||w||y||p||u||!f||(g+=5),l||c||!d||w||y||p||u||!f||(g+=6),!l||c||!d||w||y||p||u||!f||(g+=7),l||c||d||w||y||!p||u||f||(g+=8),!l||c||d||w||y||!p||u||f||(g+=9),l||c||!d||w||y||!p||u||f||(g+=10),!l||c||!d||w||y||!p||u||f||(g+=11),l||c||d||w||y||!p||u||!f||(g+=12),!l||c||d||w||y||!p||u||!f||(g+=13),l||c||!d||w||y||!p||u||!f||(g+=14),l&&!c&&d&&!w&&!y&&p&&!u&&f&&(g+=15),c||d||!w||y||u||f||(g+=16),c||!d||!w||y||u||f||(g+=17),c||d||!w||y||u||!f||(g+=18),!c&&d&&w&&!y&&!u&&f&&(g+=19),!c||w||y||p||u||f||(g+=20),!c||w||y||p||u||!f||(g+=21),!c||w||y||!p||u||f||(g+=22),c&&!w&&!y&&p&&!u&&f&&(g+=23),l||c||w||!y||p||u||(g+=24),l||c||w||!y||!p||u||(g+=25),!l||c||w||!y||p||u||(g+=26),l&&!c&&!w&&y&&p&&!u&&(g+=27),l||c||d||w||y||!u||(g+=28),!l||c||d||w||y||!u||(g+=29),l||c||!d||w||y||!u||(g+=30),l&&!c&&d&&!w&&!y&&u&&(g+=31),!c&&w&&y&&!u&&(g+=32),c&&!w&&!y&&u&&(g+=33),!c||!w||y||u||f||(g+=34),c&&w&&!y&&!u&&f&&(g+=35),!c||w||!y||p||u||(g+=36),c&&!w&&y&&p&&!u&&(g+=37),l||c||w||!y||!u||(g+=38),l&&!c&&!w&&y&&u&&(g+=39),c||d||!w||y||!u||(g+=40),!c&&d&&w&&!y&&u&&(g+=41),c&&w&&y&&!u&&(g+=42),c&&w&&!y&&u&&(g+=43),!c&&w&&y&&u&&(g+=44),c&&!w&&y&&u&&(g+=45),c&&w&&y&&u&&(g+=46),g},e.prototype.ifWallTileType=function(t,e){return t>=e&&t<e+16},e.prototype.ifcanBarr=function(t,e,i,a,s,o,h,r){var n=new Array(9);n[0]=t,n[1]=e,n[2]=i,n[3]=a,n[4]=!1,n[5]=s,n[6]=o,n[7]=h,n[8]=r;for(var l=0,c=0;c<9;c++)!0===n[c]&&(l=c);var d=[];d.push(l);for(var p=0;p<d.length;){var u=d[p];p++,n[u]=!1;for(var f=u%3,w=Math.floor(u/3),y=0;y<4;y++){var g=f+this.fourX[y],v=w+this.fourY[y];g>=0&&g<3&&v>=0&&v<3&&!0===n[3*v+g]&&d.push(3*v+g)}}for(c=0;c<9;c++)if(!0===n[c])return!1;return!0},e.prototype.walkable=function(t,e){if(this.data1[e*this.width+t]!==this.Base&&this.data1[e*this.width+t]!==this.Base2&&this.data1[e*this.width+t]!==this.WalkableBase)return!1;if(this.data3[e*this.width+t]===this.Stone22)return!1;for(var i=0;i<this.Stone1.length;i++)if(this.data3[e*this.width+t]===this.Stone1[i])return!1;return!0},e.prototype.cleardeco=function(){for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)this.data3[t*this.width+e]=0,this.data4[t*this.width+e]=0,this.data1[t*this.width+e]===this.WalkableBase&&(this.data1[t*this.width+e]=this.Base);this.data=this.data1.concat(this.data2.concat(this.data3.concat(this.data4.concat(this.data5.concat(this.data6)))))},e.prototype.adddeco=function(){for(var t=[],e=[],i=1;i<this.height-1;i++)for(var a=1;a<this.width;a++)this.ifWallTileType(this.data1[i*this.width+a],this.Wall)&&!this.ifWallTileType(this.data1[(i-1)*this.width+a],this.Wall)&&t.push(new cc.Vec2(a,i)),this.ifWallTileType(this.data1[i*this.width+a],this.Wall)&&!this.ifWallTileType(this.data1[(i+1)*this.width+a],this.Wall)&&e.push(new cc.Vec2(a,i));var s=t.length*this.ornamentsdensity;for(i=0;i<s/3;i++){var o=Math.random(),h=void 0;for(a=0;a<this.probWallTop.length;a++)o>this.probWallTop[a]&&(h=a);var r=t[Math.floor(Math.random()*t.length)];0===this.data3[r.y*this.width+r.x]&&(this.data3[r.y*this.width+r.x]=this.WallDecTop[h])}for(i=0;i<s/3;i++){for(o=Math.random(),h=void 0,a=0;a<this.probWallDown.length;a++)o>this.probWallDown[a]&&(h=a);r=e[Math.floor(Math.random()*e.length)],0===this.data3[r.y*this.width+r.x]&&(this.data3[r.y*this.width+r.x]=this.WallDecDown[h])}for(i=0;i<s/3;i++){for(o=Math.random(),h=void 0,a=0;a<this.probWall2.length;a++)o>this.probWall2[a]&&(h=a);r=t[Math.floor(Math.random()*t.length)],0===this.data3[r.y*this.width+r.x]&&0===this.data3[(r.x,r.y+1)]&&(this.data3[r.y*this.width+r.x]=this.Wall21[h],this.data3[(r.y+1)*this.width+r.x]=this.Wall22[h])}for(s=this.width*this.height*this.ornamentsdensity,i=0;i<s/4;i++){var n=1+Math.floor(Math.random()*(this.width-2)),l=1+Math.floor(Math.random()*(this.height-2));this.data1[l*this.width+n]===this.Base&&(this.data1[l*this.width+n]=this.WalkableBase)}for(i=0;i<s/4;i++)if(n=1+Math.floor(Math.random()*(this.width-2)),l=1+Math.floor(Math.random()*(this.height-2)),this.walkable(n,l)){var c=this.walkable(n-1,l-1),d=this.walkable(n,l-1),p=this.walkable(n+1,l-1),u=this.walkable(n-1,l),f=this.walkable(n+1,l),w=this.walkable(n-1,l+1),y=this.walkable(n,l+1),g=this.walkable(n+1,l+1);if(this.ifcanBarr(c,d,p,u,f,w,y,g)){o=Math.random();for(var v=0,m=0;m<this.prob1.length&&o>this.prob1[m];m++)v=m;this.data3[l*this.width+n]=this.Stone1[v]}}for(i=0;i<s/4;i++)n=1+Math.floor(Math.random()*(this.width-2)),l=1+Math.floor(Math.random()*(this.height-2)),this.walkable(n,l)&&(c=this.walkable(n-1,l-1),d=this.walkable(n,l-1),p=this.walkable(n+1,l-1),u=this.walkable(n-1,l),f=this.walkable(n+1,l),w=this.walkable(n-1,l+1),y=this.walkable(n,l+1),g=this.walkable(n+1,l+1),this.ifcanBarr(c,d,p,u,f,w,y,g)&&(this.data4[(l-1)*this.width+n]=this.Stone21,this.data3[l*this.width+n]=this.Stone22));for(i=0;i<s/4;i++)n=1+Math.floor(Math.random()*(this.width-2)),l=1+Math.floor(Math.random()*(this.height-2)),this.walkable(n,l)&&(this.data3[l*this.width+n]=this.WalkableStone);this.data=this.data1.concat(this.data2.concat(this.data3.concat(this.data4.concat(this.data5.concat(this.data6)))))},e.typeSeleceted=0,e.ornamentsdensity=.3,o([d(cc.Button)],e.prototype,"genBtn",void 0),o([d(cc.EditBox)],e.prototype,"widthText",void 0),o([d(cc.EditBox)],e.prototype,"heightText",void 0),o([d(cc.ToggleGroup)],e.prototype,"typeToggle",void 0),o([d(cc.Sprite)],e.prototype,"mapSprite",void 0),o([d(cc.Node)],e.prototype,"ornamentsNode",void 0),o([d(cc.Slider)],e.prototype,"ornamentsSlider",void 0),o([d(cc.Label)],e.prototype,"densityLabel",void 0),o([d(cc.Button)],e.prototype,"ornamentsBtn",void 0),o([d(cc.Button)],e.prototype,"clearBtn",void 0),o([d(cc.Button)],e.prototype,"saveBtn",void 0),i=o([c],e)}(cc.Component);i.default=p,cc._RF.pop()},{"./mainScript":"mainScript","./saveFile":"saveFile","./tileManager":"tileManager"}],mainScript:[function(t,e,i){"use strict";cc._RF.push(e,"d7c71y0hVtIuonI7Bgg4uwR","mainScript");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0}),i.EditorType=void 0;var h,r=cc._decorator,n=r.ccclass,l=r.property;(function(t){t.RMMV="RMMV",t.RMMZ="RMMZ"})(h=i.EditorType||(i.EditorType={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rmmvBtn=null,e.rmmzBtn=null,e}var i;return s(e,t),i=e,e.prototype.start=function(){this.rmmvBtn.node.on("click",function(){i.editorType=h.RMMV,cc.director.loadScene("typeMenu")},this),this.rmmzBtn.node.on("click",function(){i.editorType=h.RMMZ,cc.director.loadScene("typeMenu")},this)},e.editorType=h.RMMZ,o([l(cc.Button)],e.prototype,"rmmvBtn",void 0),o([l(cc.Button)],e.prototype,"rmmzBtn",void 0),i=o([n],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],mapOperScript:[function(t,e,i){"use strict";cc._RF.push(e,"82e7dfaOsNCTrZS+LWL2ARw","mapOperScript");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0});var h=cc._decorator,r=h.ccclass,n=h.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapSprite=null,e.zoomIn=null,e.zoomOut=null,e.scaleLabel=null,e.zoomscale=1,e.ifPressed=!1,e}return s(e,t),e.prototype.start=function(){var t=this;this.mapSprite.node.on(cc.Node.EventType.TOUCH_START,function(){t.ifPressed=!0},this),this.mapSprite.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){t.ifPressed&&(t.mapSprite.node.x+=e.touch._point.x-e.touch._prevPoint.x,t.mapSprite.node.y+=e.touch._point.y-e.touch._prevPoint.y)},this),this.mapSprite.node.on(cc.Node.EventType.TOUCH_END,function(){t.ifPressed=!1},this),this.zoomIn.node.on("click",function(){t.zoomscale+=.2,t.zoomscale<.01&&(t.zoomscale=.01),t.zoomscale>10&&(t.zoomscale=10),t.mapSprite.node.scale=t.zoomscale,t.scaleLabel.string=Math.round(100*t.zoomscale).toString()+"%"},this),this.zoomOut.node.on("click",function(){t.zoomscale-=.2,t.zoomscale<.01&&(t.zoomscale=.01),t.zoomscale>10&&(t.zoomscale=10),t.mapSprite.node.scale=t.zoomscale,t.scaleLabel.string=Math.round(100*t.zoomscale).toString()+"%"},this)},o([n(cc.Sprite)],e.prototype,"mapSprite",void 0),o([n(cc.Button)],e.prototype,"zoomIn",void 0),o([n(cc.Button)],e.prototype,"zoomOut",void 0),o([n(cc.Label)],e.prototype,"scaleLabel",void 0),o([r],e)}(cc.Component);i.default=l,cc._RF.pop()},{}],saveFile:[function(t,e,i){"use strict";cc._RF.push(e,"64369WZHzhOv4kKRM71h/Np","saveFile"),Object.defineProperty(i,"__esModule",{value:!0}),i.saveFile=void 0;var a=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),t.prototype.tostring=function(t,e,i,a){return'\n        {\n            "autoplayBgm": false,\n            "autoplayBgs": false,\n            "battleback1Name": "",\n            "battleback2Name": "",\n            "bgm": {\n              "name": "",\n              "pan": 0,\n              "pitch": 100,\n              "volume": 90\n            },\n            "bgs": {\n              "name": "",\n              "pan": 0,\n              "pitch": 100,\n              "volume": 90\n            },\n            "disableDashing": false,\n            "displayName": "",\n            "encounterList": [],\n            "encounterStep": 30,\n            "height": '+i+',\n            "note": "",\n            "parallaxLoopX": false,\n            "parallaxLoopY": false,\n            "parallaxName": "",\n            "parallaxShow": true,\n            "parallaxSx": 0,\n            "parallaxSy": 0,\n            "scrollType": 0,\n            "specifyBattleback": true,\n            "tilesetId": '+t+',\n            "width":'+e+',\n            "data":['+a+'],\n            "events":[]\n        }\n        '},t.prototype.saveMap=function(t,e,i){var a;if("function"==typeof window.Blob)a=new Blob([t],{type:e});else{var s=new(window.BlobBuilder||window.MozBlobBuilder||window.WebKitBlobBuilder||window.MSBlobBuilder);s.append(t),a=s.getBlob(e)}var o=(window.URL||window.webkitURL).createObjectURL(a),h=document.createElement("a");if("download"in h){h.style.visibility="hidden",h.href=o,h.download=i,document.body.appendChild(h);var r=document.createEvent("MouseEvents");r.initEvent("click",!0,!0),h.dispatchEvent(r),document.body.removeChild(h)}else navigator.msSaveBlob?navigator.msSaveBlob(a,i):location.href=o},t}();i.saveFile=a,cc._RF.pop()},{}],tileManager:[function(t,e,i){"use strict";cc._RF.push(e,"be05cSXPlxFH6Y5CRD2VNau","tileManager");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0}),i.TileSet=i.Tile=i.Tilesetsdata=void 0;var h=t("./mainScript"),r=cc._decorator,n=r.ccclass;r.property,i.Tilesetsdata=[null,{id:1,mode:0,name:"\u4e16\u754c",note:"",tilesetNames:["World_A1","World_A2","","","","World_B","World_C","",""]},{id:2,mode:1,name:"\u5916\u89c2",note:"",tilesetNames:["Outside_A1","Outside_A2","Outside_A3","Outside_A4","Outside_A5","Outside_B","Outside_C","",""]},{id:3,mode:1,name:"\u5185\u90e8",note:"",tilesetNames:["Inside_A1","Inside_A2","","Inside_A4","Inside_A5","Inside_B","Inside_C","",""]},{id:4,mode:1,name:"\u5730\u4e0b\u57ce",note:"",tilesetNames:["Dungeon_A1","Dungeon_A2","","Dungeon_A4","Dungeon_A5","Dungeon_B","Dungeon_C","",""]},{id:5,mode:1,name:"\u8fd1\u672a\u6765\u5916\u89c2",note:"",tilesetNames:["Outside_A1","Outside_A2","SF_Outside_A3","SF_Outside_A4","SF_Outside_A5","SF_Outside_B","SF_Outside_C","",""]},{id:6,mode:1,name:"\u8fd1\u672a\u6765\u5185\u90e8",note:"",tilesetNames:["Inside_A1","Inside_A2","","SF_Inside_A4","SF_Outside_A5","SF_Inside_B","SF_Inside_C","",""]}];var l=function(){};i.Tile=l;var c=function(){function t(e){if(this.id=e,t.finished=0,this.name=i.Tilesetsdata[e].name,this.tiletextures=new Array(8192),""!==i.Tilesetsdata[e].tilesetNames[0]){var a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[0]+".png";this.A1=new Image,this.A1.crossOrigin="anonymous",this.A1.src=cc.url.raw(a);var s=this;this.A1.onload=function(){s.analyseA1(s.A1),t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[1]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[1]+".png",this.A2=new Image,this.A2.crossOrigin="anonymous",this.A2.src=cc.url.raw(a);var o=this;this.A2.onload=function(){o.analyseA2(o.A2),t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[2]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[2]+".png",this.A3=new Image,this.A3.crossOrigin="anonymous",this.A3.src=cc.url.raw(a);var r=this;this.A3.onload=function(){r.analyseA3(r.A3),t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[3]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[3]+".png",this.A4=new Image,this.A4.crossOrigin="anonymous",this.A4.src=cc.url.raw(a);var n=this;this.A4.onload=function(){n.analyseA4(n.A4),t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[4]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[4]+".png",this.A5=new Image,this.A5.crossOrigin="anonymous",this.A5.src=cc.url.raw(a);var c=this;this.A5.onload=function(){for(var e=0;e<16;e++)for(var i=0;i<16;i++)c.tiletextures[8*e+i+1536]=new l,c.tiletextures[8*e+i+1536].img=c.A5,c.tiletextures[8*e+i+1536].locUL=new cc.Vec2(48*i,48*e),c.tiletextures[8*e+i+1536].locUR=new cc.Vec2(48*i+24,48*e),c.tiletextures[8*e+i+1536].locDL=new cc.Vec2(48*i,48*e+24),c.tiletextures[8*e+i+1536].locDR=new cc.Vec2(48*i+24,48*e+24);t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[5]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[5]+".png",this.B=new Image,this.B.crossOrigin="anonymous",this.B.src=cc.url.raw(a);var d=this;this.B.onload=function(){for(var e=0;e<16;e++)for(var i=0;i<8;i++)d.tiletextures[8*e+i]=new l,d.tiletextures[8*e+i+128]=new l,d.tiletextures[8*e+i].img=d.B,d.tiletextures[8*e+i+128].img=d.B,d.tiletextures[8*e+i].locUL=new cc.Vec2(48*i,48*e),d.tiletextures[8*e+i].locUR=new cc.Vec2(48*i+24,48*e),d.tiletextures[8*e+i].locDL=new cc.Vec2(48*i,48*e+24),d.tiletextures[8*e+i].locDR=new cc.Vec2(48*i+24,48*e+24),d.tiletextures[8*e+i+128].locUL=new cc.Vec2(48*(8+i),48*e),d.tiletextures[8*e+i+128].locUR=new cc.Vec2(48*(8+i)+24,48*e),d.tiletextures[8*e+i+128].locDL=new cc.Vec2(48*(8+i),48*e+24),d.tiletextures[8*e+i+128].locDR=new cc.Vec2(48*(8+i)+24,48*e+24);t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[6]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[6]+".png",this.C=new Image,this.C.crossOrigin="anonymous",this.C.src=cc.url.raw(a);var p=this;this.C.onload=function(){for(var e=0;e<16;e++)for(var i=0;i<8;i++)p.tiletextures[8*e+i+256]=new l,p.tiletextures[8*e+i+384]=new l,p.tiletextures[8*e+i+256].img=p.C,p.tiletextures[8*e+i+384].img=p.C,p.tiletextures[8*e+i+256].locUL=new cc.Vec2(48*i,48*e),p.tiletextures[8*e+i+256].locUR=new cc.Vec2(48*i+24,48*e),p.tiletextures[8*e+i+256].locDL=new cc.Vec2(48*i,48*e+24),p.tiletextures[8*e+i+256].locDR=new cc.Vec2(48*i+24,48*e+24),p.tiletextures[8*e+i+384].locUL=new cc.Vec2(48*(8+i),48*e),p.tiletextures[8*e+i+384].locUR=new cc.Vec2(48*(8+i)+24,48*e),p.tiletextures[8*e+i+384].locDL=new cc.Vec2(48*(8+i),48*e+24),p.tiletextures[8*e+i+384].locDR=new cc.Vec2(48*(8+i)+24,48*e+24);t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[7]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[7]+".png",this.D=new Image,this.D.crossOrigin="anonymous",this.D.src=cc.url.raw(a);var u=this;this.D.onload=function(){for(var e=0;e<16;e++)for(var i=0;i<8;i++)u.tiletextures[8*e+i+512]=new l,u.tiletextures[8*e+i+640]=new l,u.tiletextures[8*e+i+512].img=u.D,u.tiletextures[8*e+i+640].img=u.D,u.tiletextures[8*e+i+512].locUL=new cc.Vec2(48*i,48*e),u.tiletextures[8*e+i+512].locUR=new cc.Vec2(48*i+24,48*e),u.tiletextures[8*e+i+512].locDL=new cc.Vec2(48*i,48*e+24),u.tiletextures[8*e+i+512].locDR=new cc.Vec2(48*i+24,48*e+24),u.tiletextures[8*e+i+640].locUL=new cc.Vec2(48*(8+i),48*e),u.tiletextures[8*e+i+640].locUR=new cc.Vec2(48*(8+i)+24,48*e),u.tiletextures[8*e+i+640].locDL=new cc.Vec2(48*(8+i),48*e+24),u.tiletextures[8*e+i+640].locDR=new cc.Vec2(48*(8+i)+24,48*e+24);t.finished++}}else t.finished++;if(""!==i.Tilesetsdata[e].tilesetNames[8]){a="resources/"+h.default.editorType+"/"+i.Tilesetsdata[e].tilesetNames[8]+".png",this.E=new Image,this.E.crossOrigin="anonymous",this.E.src=cc.url.raw(a);var f=this;this.E.onload=function(){for(var e=0;e<16;e++)for(var i=0;i<8;i++)f.tiletextures[8*e+i+768]=new l,f.tiletextures[8*e+i+896]=new l,f.tiletextures[8*e+i+768].img=f.E,f.tiletextures[8*e+i+896].img=f.E,f.tiletextures[8*e+i+768].locUL=new cc.Vec2(48*i,48*e),f.tiletextures[8*e+i+768].locUR=new cc.Vec2(48*i+24,48*e),f.tiletextures[8*e+i+768].locDL=new cc.Vec2(48*i,48*e+24),f.tiletextures[8*e+i+768].locDR=new cc.Vec2(48*i+24,48*e+24),f.tiletextures[8*e+i+896].locUL=new cc.Vec2(48*(8+i),48*e),f.tiletextures[8*e+i+896].locUR=new cc.Vec2(48*(8+i)+24,48*e),f.tiletextures[8*e+i+896].locDL=new cc.Vec2(48*(8+i),48*e+24),f.tiletextures[8*e+i+896].locDR=new cc.Vec2(48*(8+i)+24,48*e+24);t.finished++}}else t.finished++}return t.prototype.analyseA1=function(t){this.generateFloor(t,0,0,96,144,2048),this.generateFloor(t,288,0,96,144,2144),this.generateFloor(t,384,0,96,144,2240),this.generateFloor(t,0,144,96,144,2096),this.generateFloor(t,288,144,96,144,2192),this.generateFloor(t,384,144,96,144,2336),this.generateFloor(t,0,288,96,144,2432),this.generateFloor(t,384,288,96,144,2624),this.generateFloor(t,0,432,96,144,2528),this.generateFloor(t,384,432,96,144,2720)},t.prototype.analyseA2=function(t){for(var e=0;e<4;e++)for(var i=0;i<8;i++)this.generateFloor(t,96*i,144*e,96,144,2816+48*(8*e+i))},t.prototype.analyseA3=function(t){for(var e=0;e<4;e++)for(var i=0;i<8;i++)this.generateWall(t,96*i,96*e,96,96,4352+48*(8*e+i))},t.prototype.analyseA4=function(t){for(var e=0;e<3;e++)for(var i=0;i<8;i++)this.generateFloor(t,96*i,240*e,96,144,5888+48*i+768*e),this.generateWall(t,96*i,240*e+144,96,96,6272+48*i+768*e)},t.prototype.generateFloor=function(t,e,i,a,s,o){var h=[];h[0]=[18,17,14,13],h[1]=[2,17,14,13],h[2]=[18,3,14,13],h[3]=[2,3,14,13],h[4]=[18,17,14,7],h[5]=[2,17,14,7],h[6]=[18,3,14,7],h[7]=[2,3,14,7],h[8]=[18,17,6,13],h[9]=[2,17,6,13],h[10]=[18,3,6,13],h[11]=[2,3,6,13],h[12]=[18,17,6,7],h[13]=[2,17,6,7],h[14]=[18,3,6,7],h[15]=[2,3,6,7],h[16]=[16,17,12,13],h[17]=[16,3,12,13],h[18]=[16,17,12,7],h[19]=[16,3,12,7],h[20]=[10,9,14,13],h[21]=[10,9,14,7],h[22]=[10,9,6,13],h[23]=[10,9,6,7],h[24]=[18,19,14,15],h[25]=[18,19,6,15],h[26]=[2,19,14,15],h[27]=[2,19,6,15],h[28]=[18,17,22,21],h[29]=[2,17,22,21],h[30]=[18,3,22,21],h[31]=[2,3,22,21],h[32]=[16,19,12,15],h[33]=[10,9,22,21],h[34]=[8,9,12,13],h[35]=[8,9,12,7],h[36]=[10,11,14,15],h[37]=[10,11,6,15],h[38]=[18,19,22,23],h[39]=[2,19,22,23],h[40]=[16,17,20,21],h[41]=[16,3,20,21],h[42]=[8,11,12,15],h[43]=[8,9,20,21],h[44]=[16,19,20,23],h[45]=[10,11,22,23],h[46]=[8,11,20,23],h[47]=[0,1,4,5];for(var r=0;r<48;r++){this.tiletextures[o+r]=new l,this.tiletextures[o+r].img=t;var n=h[r][0]%4*24,c=24*Math.floor(h[r][0]/4),d=h[r][1]%4*24,p=24*Math.floor(h[r][1]/4),u=h[r][2]%4*24,f=24*Math.floor(h[r][2]/4),w=h[r][3]%4*24,y=24*Math.floor(h[r][3]/4);this.tiletextures[o+r].locUL=new cc.Vec2(e+n,i+c),this.tiletextures[o+r].locUR=new cc.Vec2(e+d,i+p),this.tiletextures[o+r].locDL=new cc.Vec2(e+u,i+f),this.tiletextures[o+r].locDR=new cc.Vec2(e+w,i+y)}},t.prototype.generateWall=function(t,e,i,a,s,o){var h=[];h[0]=[10,9,6,5],h[1]=[8,9,4,5],h[2]=[2,1,6,5],h[3]=[0,1,4,5],h[4]=[10,11,6,7],h[5]=[8,11,4,7],h[6]=[2,3,6,7],h[7]=[0,3,4,7],h[8]=[10,9,14,13],h[9]=[8,9,12,13],h[10]=[2,1,14,13],h[11]=[0,1,12,13],h[12]=[10,11,14,15],h[13]=[8,11,12,15],h[14]=[2,3,14,15],h[15]=[0,3,12,15];for(var r=0;r<16;r++){this.tiletextures[o+r]=new l,this.tiletextures[o+r].img=t;var n=h[r][0]%4*24,c=24*Math.floor(h[r][0]/4),d=h[r][1]%4*24,p=24*Math.floor(h[r][1]/4),u=h[r][2]%4*24,f=24*Math.floor(h[r][2]/4),w=h[r][3]%4*24,y=24*Math.floor(h[r][3]/4);this.tiletextures[o+r].locUL=new cc.Vec2(e+n,i+c),this.tiletextures[o+r].locUR=new cc.Vec2(e+d,i+p),this.tiletextures[o+r].locDL=new cc.Vec2(e+u,i+f),this.tiletextures[o+r].locDR=new cc.Vec2(e+w,i+y)}},t}();i.TileSet=c;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var i;return s(e,t),i=e,e.prototype.start=function(){i.tileSets=[];for(var t=1;t<7;t++)i.tileSets.push(new c(t))},i=o([n],e)}(cc.Component);i.default=d,cc._RF.pop()},{"./mainScript":"mainScript"}],typeScript:[function(t,e,i){"use strict";cc._RF.push(e,"53e8cSxrS5IP7X6tmtSYE4K","typeScript");var a,s=this&&this.__extends||(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__decorate||function(t,e,i,a){var s,o=arguments.length,h=o<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,a);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(h=(o<3?s(h):o>3?s(e,i,h):s(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h};Object.defineProperty(i,"__esModule",{value:!0});var h=t("./mainScript"),r=cc._decorator,n=r.ccclass,l=r.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title=null,e.caveBtn=null,e}return s(e,t),e.prototype.start=function(){this.title.string="Map Generator for "+h.default.editorType,this.caveBtn.node.on("click",function(){cc.director.loadScene("caveScene")},this)},o([l(cc.Label)],e.prototype,"title",void 0),o([l(cc.Button)],e.prototype,"caveBtn",void 0),o([n],e)}(cc.Component);i.default=c,cc._RF.pop()},{"./mainScript":"mainScript"}]},{},["LoadingScript","caveScript","mainScript","mapOperScript","saveFile","tileManager","typeScript"]);